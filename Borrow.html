<template name="borrow">
 	<h2>Le livre que vous cherchez est sûrement disponible près de chez vous !</h2>

	{{> searchToBorrow}}
	
	{{> displayAvailableBooks}}
</template>

<template name="searchToBorrow">
	<h5>Un titre en tête?</h5>
	 <form>
        <input type="text" name="searchedBook" placeholder="Titre du livre recherché">
        <input type="submit" value="Recherchez dans Colibry">
    </form>

    <div class="row">
	<div class="col-xs-12 col-sm-6 col-md-8"> {{> displaySearchedBooks}}
	</div>
	<div class="center-block">
	<div class="col-xs-6 col-md-4"> {{> displayChosenBook}}
    </div>
    </div>
    </div>
</template>

<template name="displayAvailableBooks">
	<h5>L'ensemble des livres disponibles dans la communauté</h5>
	<div class="panel-body">
      	<div class="row">
      	 {{#each availableBooks}}
    			<a class="img-thumbnail img-responsive">
     			<!-- Référence au template bookimage pour afficher l'image du livre dans une div -->
           {{> bookimage}}         
    			</a>
  			{{/each}}
  		</div>	
  	</div>
</template>

<template name="displaySearchedBooks">
	<h5>Livres disponibles à l'emprunt correspondants à votre recherche</h5>
	 <div class="panel-body">
      	<div class="row">
	      	{{#if tryToSearch}}
		      	{{#if searchInAllAvailableBooks.count}}
		      	 {{#each searchInAllAvailableBooks}}
		    			<a class="img-thumbnail img-responsive proposedBook">
		     			<!-- Référence au template bookimage pour afficher l'image du livre dans une div -->
		           {{> bookimage}}         
		    			</a>
		  			{{/each}}
		  		{{else}}
		         <!-- Phrase si pas de livre dans cette partie de la biblio...-->
		         Désolé! Aucun livre de notre base de donnéee ne correspond à votre recherche!
		        {{/if}}
		    {{else}}
		    <!-- Phrase avant de faire une recherche...-->
		         Vas y cherche !
		    {{/if}}
  		</div>	
  	</div>
</template>

<!-- TEMPLATE pour afficher le livre actuellement sélectionné dans la proposition suite à la recherche  -->
<template name="displayChosenBook">
	{{#if myChosenBook}}
		{{#if currentUser}}
			<div class="thumbnail">
		      <img class="thumb-books" src="{{myChosenBook.thumb}}" width="100" height="140">
		      <div class="caption">
		        <h3>{{myChosenBook.title}} by {{myChosenBook.authors}}</h3>
		        <p>{{myChosenBook.snippet}}</p>
		        <p class="text-center"></p>
		     	<h5>Certains utilisateurs peuvent te le préter :</h5>
		     	{{#each usersWhoShareIt}}
		    		<li>{{bookOwner}}</li>
				{{/each}}
		      </div>
		    </div>
	    {{else}}
	    	<div class="thumbnail">
		      <img class="thumb-books" src="{{myChosenBook.thumb}}" width="100" height="140">
		      <div class="caption">
		        <h3>{{myChosenBook.title}} by {{myChosenBook.authors}}</h3>
		        <p>{{myChosenBook.snippet}}</p>
		        <p class="text-center"></p>
		     	<h5>Ce livre est disponible et {{usersWhoShareIt.count}} utilisateurs peuvent te le prêter</h5>
		     	<h5>Connecte-toi vite pour les contacter!</h5>
		     	<!-- Le bouton remove est actif grâce à la class erase-book -->
        		<p><a class="se connecter" role="button"> Se connecter</a> </p> <p><a class="s'inscrire" role="button"> S'inscrire</a> </p>          		
		     </div>
		    </div>
    	{{/if}}
    {{/if}}
</template>